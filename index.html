<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½è³€è‡ªé§•æ—…ç¨‹æŒ‡å—</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* ä½¿ç”¨ Inter å­—é«”ä»¥ç²å¾—ä¹¾æ·¨çš„æ¥µç°¡å¤–è§€ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7; /* è¼•å¾®çš„ç±³ç™½èƒŒæ™¯ */
        }
        /* è‡ªè¨‚æ»¾å‹•æ¢æ¨£å¼ï¼Œè®“æ‰‹æ©Ÿé«”é©—æ›´ä½³ */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        .text-vermilion { /* ç¥ç¤¾æœ±ç´…è‰²èª¿ */
            color: #d84315;
        }
        .bg-vermilion-50 {
            background-color: #fff3e0;
        }
        /* éš±è—æœªé¸ä¸­çš„åˆ†é å…§å®¹ */
        .tab-content {
            display: none;
        }
        .active-tab {
            border-bottom: 2px solid #d84315;
            color: #d84315;
            font-weight: 600;
        }
    </style>
</head>
<body class="min-h-screen pb-20">

    <!-- é ‚éƒ¨æ¨™é¡Œå’Œåˆ†é å°èˆª -->
    <div class="fixed top-0 left-0 right-0 bg-white z-10 shadow-sm border-b border-gray-200">
        <header class="max-w-xl mx-auto p-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-gray-800">ä½è³€è‡ªé§•æ—…ç¨‹</h1>
            <div id="date-display" class="text-sm font-medium text-gray-500"></div>
        </header>

        <!-- åˆ†é å°èˆª -->
        <nav class="flex justify-around max-w-xl mx-auto text-center text-gray-600">
            <button class="tab-button w-1/2 py-3 transition-colors active-tab" onclick="showTab('itinerary-tab', this)">
                <i data-lucide="map"></i> è¡Œç¨‹è¦åŠƒ
            </button>
            <button class="tab-button w-1/2 py-3 transition-colors" onclick="showTab('tools-tab', this)">
                <i data-lucide="wrench"></i> å¯¦ç”¨å·¥å…·
            </button>
        </nav>
    </div>

    <!-- ä¸»å…§å®¹å€å¡Š (å¡«å……é ‚éƒ¨å›ºå®šå°èˆªçš„é«˜åº¦) -->
    <main class="max-w-xl mx-auto pt-32 p-4">

        <!-- è¡Œç¨‹è¦åŠƒåˆ†é  -->
        <div id="itinerary-tab" class="tab-content block">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">æ¯æ—¥è¡Œç¨‹ç¸½è¦½</h2>
            <div id="itinerary-list" class="space-y-6">
                <!-- è¡Œç¨‹å¡ç‰‡å°‡ç”± JavaScript ç”Ÿæˆ -->
            </div>
        </div>

        <!-- å¯¦ç”¨å·¥å…·åˆ†é  -->
        <div id="tools-tab" class="tab-content hidden">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">æ—…é€”å¯¦ç”¨è³‡è¨Š</h2>

            <!-- è³‡è¨Šå¡ç‰‡ -->
            <div class="space-y-6">

                <!-- èˆªç­èˆ‡ä½å®¿è³‡è¨Š -->
                <div class="p-5 bg-white shadow-lg rounded-xl">
                    <h3 class="flex items-center text-lg font-semibold mb-3 text-vermilion">
                        <i data-lucide="plane" class="w-5 h-5 mr-2"></i> èˆªç­èˆ‡ä½å®¿
                    </h3>
                    <div class="space-y-3 text-sm text-gray-700">
                        <p class="border-b pb-2">
                            <span class="font-medium text-gray-500">ä½å®¿ï¼š</span>
                            <span class="font-bold">æ±æ©«INNä½è³€ç«™å‰</span>
                        </p>
                        <p class="border-b pb-2">
                            <span class="font-medium text-gray-500">åœ°å€ï¼š</span>
                            ä½è³€çœŒä½è³€å¸‚é§…å‰ä¸­å¤®1-10-36
                        </p>
                        <p class="border-b pb-2">
                            <span class="font-medium text-gray-500">å»ç¨‹ï¼š</span>
                            IT246 (07:10 æ¡ƒåœ’ â†’ 10:25 ä½è³€)
                        </p>
                        <p>
                            <span class="font-medium text-gray-500">å›ç¨‹ï¼š</span>
                            IT247 (12:15 ä½è³€ â†’ 13:45 æ¡ƒåœ’)
                        </p>
                    </div>
                    <!-- é ç•™é ç´„ä»£è™Ÿäº®é¡¯ -->
                    <div class="mt-4 p-3 bg-red-50 rounded-lg text-sm text-red-600 border border-red-200">
                        <p class="font-bold">é‡è¦æé†’ï¼š</p>
                        <p>è«‹åœ¨æ­¤è™•å¡«å¯«æ‚¨çš„ <span class="text-red-700 font-extrabold">æ©Ÿç¥¨é ç´„ä»£è™Ÿ</span> æˆ– <span class="text-red-700 font-extrabold">é£¯åº—è¨‚å–®ç·¨è™Ÿ</span>ï¼Œæ–¹ä¾¿éš¨æ™‚æŸ¥é–±ã€‚</p>
                    </div>
                </div>

                <!-- ç·Šæ€¥è¯çµ¡é›»è©± -->
                <div class="p-5 bg-white shadow-lg rounded-xl">
                    <h3 class="flex items-center text-lg font-semibold mb-3 text-vermilion">
                        <i data-lucide="phone-call" class="w-5 h-5 mr-2"></i> ç·Šæ€¥è¯çµ¡é›»è©±
                    </h3>
                    <ul class="text-sm text-gray-700 space-y-2">
                        <li>
                            <span class="font-medium text-gray-500">è­¦å¯Ÿ (110)ï¼š</span>
                            <a href="tel:+81110" class="text-blue-500 hover:underline">æ’¥æ‰“ 110</a>
                        </li>
                        <li>
                            <span class="font-medium text-gray-500">æ•‘è­·è»Š/æ¶ˆé˜² (119)ï¼š</span>
                            <a href="tel:+81119" class="text-blue-500 hover:underline">æ’¥æ‰“ 119</a>
                        </li>
                        <li>
                            <span class="font-medium text-gray-500">ä¿¡ç”¨å¡éºå¤±ï¼š</span>
                            è«‹è‡ªè¡Œå¡«å¯«éŠ€è¡Œå®¢æœé›»è©±
                        </li>
                        <li>
                            <span class="font-medium text-gray-500">é§ç¦å²¡è¾¦äº‹è™•ï¼š</span>
                            +81-92-734-2810
                        </li>
                    </ul>
                </div>

                <!-- è¨˜å¸³/é ç®—è¡¨ -->
                <div class="p-5 bg-white shadow-lg rounded-xl">
                    <h3 class="flex items-center text-lg font-semibold mb-3 text-vermilion">
                        <i data-lucide="wallet" class="w-5 h-5 mr-2"></i> è¨˜å¸³/é ç®—è¡¨
                    </h3>
                    <div class="space-y-3">
                        <div class="flex space-x-2">
                            <input type="text" id="expense-item" placeholder="é …ç›® (e.g. åˆé¤)" class="flex-grow p-2 border border-gray-300 rounded-lg text-sm focus:ring-vermilion focus:border-vermilion" />
                            <input type="number" id="expense-amount" placeholder="é‡‘é¡ (æ—¥åœ“)" class="w-1/3 p-2 border border-gray-300 rounded-lg text-sm focus:ring-vermilion focus:border-vermilion" />
                            <button onclick="addExpense()" class="bg-vermilion-50 text-vermilion border border-red-200 px-4 rounded-lg font-semibold text-sm hover:bg-red-100 transition-colors flex-shrink-0">æ–°å¢</button>
                        </div>

                        <div id="expense-list" class="space-y-2 max-h-48 overflow-y-auto pr-2">
                            <!-- è²»ç”¨åˆ—è¡¨ -->
                        </div>

                        <div class="pt-3 border-t-2 border-dashed border-gray-200 mt-3 flex justify-between font-bold text-gray-800">
                            <span>ç¸½æ”¯å‡ºï¼š</span>
                            <span id="total-expense">0 JPY</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </main>

    <script>
        // åˆå§‹åŒ– Lucide Icons
        lucide.createIcons();

        // è¼‰å…¥è¡Œç¨‹è³‡æ–™ (å·²æ ¹æ“šä½¿ç”¨è€…æä¾›çš„æ–‡ä»¶æ›´æ–°)
        const itineraryData = [
            {
                day: 1,
                date: "12/14 (æ—¥)",
                location: "ä½è³€å¸‚/å‰é‡ãƒ¶é‡Œ",
                weather: "Saga",
                events: [
                    { time: "07:10-10:25", title: "âœˆï¸ èˆªç­æŠµé”ï¼šæ¡ƒåœ’ â†’ ä½è³€æ©Ÿå ´ (HSG)", type: "transport", note: "IT246 æ¡ƒåœ’ â†’ ä½è³€", locationName: "ä½è³€æ©Ÿå ´", isKey: true },
                    { time: "10:45", title: "ğŸš æ­ä¹˜æ©Ÿå ´å·´å£«è‡³ä½è³€ç«™ï¼Œæ±æ©«INNå¯„æ”¾è¡Œæ", type: "transport", locationName: "æ±æ©«INNä½è³€ç«™å‰", note: "ä¸‹è»Šå¾Œæ­¥è¡Œ 3 åˆ†é˜ã€‚11:30 å‰å¾Œæº–å‚™å‡ºç™¼" },
                    { time: "11:45-12:15", title: "åˆé¤ï¼šä½è³€ç«™å‘¨é‚Šç°¡å–®åƒ", type: "dining", locationName: "ä½è³€ç«™å‘¨é‚Š", note: "å¿«é€Ÿçœæ™‚ï¼šç«™å‰é£Ÿå ‚ã€å‰é‡å®¶ã€MOSã€ç«‹ã¡é£Ÿã„çƒé¾éºµ", isKey: false },
                    { time: "12:30-15:00", title: "ğŸ¯ å‰é‡ãƒ¶é‡Œæ­·å²å…¬åœ’ï¼ˆå½Œç”Ÿæ™‚ä»£éºè·¡ï¼‰", type: "attraction", locationName: "å‰é‡ãƒ¶é‡Œæ­´å²å…¬åœ’", note: "äº¤é€šï¼šJRä½è³€ç«™ â†’ å‰é‡ãƒ¶é‡Œå…¬åœ’ç«™ (ç´„12åˆ†é˜)ã€‚åœç•™é‡é»ï¼šå—å…§éƒ­ãƒ»åŒ—å…§éƒ­ç­‰ã€‚", isKey: true },
                    { time: "15:30-17:30", title: "ğŸ› BOOKOFF æ™‚é–“ï¼ˆé«˜æœ¨ç€¨åº— æˆ– PLUS æ——è‰¦åº—ï¼‰", type: "shopping", locationName: "BOOKOFF", note: "è¦–ç²¾ç¥èˆ‡ç§»å‹•æ™‚é–“é¸ 1â€“2 é–“ã€‚", guide: "<span class='font-bold text-red-700'>å¼·çƒˆæ¨è–¦ï¼š</span>BOOKOFF PLUS ä½è³€å—éƒ¨ç¹é“åº—ï¼ˆæœ€å¤§è¦æ¨¡æ——è‰¦åº—ï¼‰ã€‚", isKey: true },
                    { time: "18:30", title: "æ™šé¤ï¼šç‡’è‚‰å…‰å·åœ’", type: "dining", locationName: "ç‡’è‚‰å…‰å·åœ’", note: "åœ°å€ï¼šSaga, Otakara, 4 Chomeâˆ’2âˆ’7ã€‚", guide: "<span class='font-bold text-red-700'>é‡è¦æé†’ï¼š</span>åªæ”¶ç¾é‡‘!!", isKey: true },
                    { time: "20:00", title: "ğŸ¨ å›é£¯åº—ä¼‘æ¯", type: "transport", locationName: "æ±æ©«INNä½è³€ç«™å‰", note: "æ˜å¤©é–‹å§‹è‡ªé§•è¡Œç¨‹ã€‚", isKey: false },
                ]
            },
            {
                day: 2,
                date: "12/15 (ä¸€)",
                location: "å‘¼å­/å”æ´¥",
                weather: "Karatsu",
                events: [
                    { time: "08:00", title: "ğŸš— é£¯åº—å‡ºç™¼ â†’ å‘¼å­æœå¸‚", type: "transport", note: "è»Šç¨‹ç´„ 60 åˆ†ã€‚å°èˆªï¼šå‘¼å­æœå¸‚é€šã‚Šã€‚", locationName: "å‘¼å­æœå¸‚", isKey: false },
                    { time: "09:00-10:00", title: "ğŸ¦‘ å‘¼å­æœå¸‚æ•£ç­–", type: "attraction", locationName: "å‘¼å­æœå¸‚é€šã‚Š", note: "ç”Ÿçƒè³Šåˆºèº«ã€çƒè³Šæ¼¢å ¡ã€çƒè³Šç‡’è³£ã€è¾²ç”¢åœŸç”¢ã€‚", isKey: true },
                    { time: "10:15-11:30", title: "ğŸ± åˆé¤ï¼šæ´»çƒè³Šå®šé£Ÿï¼ˆå»ºè­°ï¼‰", type: "dining", locationName: "å‘¼å­", note: "ååº—æ¨è–¦ï¼šæ²³å¤ªéƒ å‘¼å­åº—ï¼ˆéœ€æ’éšŠï¼‰ã€å‘¼å­æµ·èˆŸï¼ˆæµ·æ™¯æ¥µä½³ï¼‰ã€‚", isKey: true },
                    { time: "12:00-13:00", title: "ğŸ° å”æ´¥åŸ", type: "attraction", locationName: "å”æ´¥åŸ", note: "åŸä¸‹ç”ºæ•£æ­¥ã€å¤©å®ˆé–£å±•æœ›ã€ä½è³€æ­¦å£«æ–‡åŒ–å±•ç¤ºã€‚", guide: "<span class='font-bold text-blue-700'>åœè»Šè³‡è¨Šï¼š</span>åœè»Šå ´åœ¨çºœè»Šæ—ã€‚", isKey: true },
                    { time: "13:15-14:30", title: "ğŸŒ… é¸é…æ™¯é»ï¼šè™¹ä¹‹æ¾åŸï¼èˆŠé«˜å–é‚¸", type: "attraction", locationName: "è™¹ä¹‹æ¾åŸ/èˆŠé«˜å–é‚¸", note: "å…©è€…çš†é †è·¯ã€‚", isKey: false },
                    { time: "15:00-16:00", title: "ğŸ—» é¡å±±å±•æœ›å°", type: "attraction", locationName: "é¡å±±å±•æœ›å°", note: "åœç•™ 40 åˆ†é˜è¶³å¤ ã€‚", guide: "<span class='font-bold text-green-700'>å¿…çœ‹ï¼š</span>çœºæœ›å”æ´¥ç£ï¼‹è™¹ä¹‹æ¾åŸæµ·å²¸ç·šï¼Œéå¸¸å€¼å¾—ã€‚", isKey: true },
                    { time: "17:00", title: "ğŸš— å›ä½è³€å¸‚å€", type: "transport", locationName: "ä½è³€å¸‚å€", note: "è»Šç¨‹ç´„ 1 å°æ™‚ã€‚", isKey: false },
                    { time: "18:30", title: "æ™šé¤ï¼šä½è³€å¸‚å€ï¼ˆè‡ªè¨‚ï¼‰", type: "dining", locationName: "ä½è³€å¸‚å€", note: "é¸æ“‡ï¼šä¸­è¯æ–™ç† å­Ÿæ¸“è‹‘ æˆ– Seafood Izakaya Sakanaya Dojoã€‚", isKey: true },
                ]
            },
            {
                day: 3,
                date: "12/16 (äºŒ)",
                location: "é¹¿å³¶/æ­¦é›„",
                weather: "Kashima",
                events: [
                    { time: "08:30", title: "ğŸš— é£¯åº—å‡ºç™¼ â†’ ç¥å¾·ç¨»è·ç¥ç¤¾", type: "transport", note: "è»Šç¨‹ç´„ 60 åˆ†ã€‚å°èˆªï¼šç¥å¾·ç¨²è·ç¥ç¤¾é§è»Šå ´ã€‚", locationName: "ç¥å¾·ç¨²è·ç¥ç¤¾", isKey: false },
                    { time: "09:30-11:00", title: "â›©ï¸ ç¥å¾·ç¨»è·ç¥ç¤¾", type: "attraction", locationName: "ç¥å¾·ç¨»è·ç¥ç¤¾", note: "é®®ç´…æœ¬æ®¿ã€ä¼è¦‹ç¨»è·ç³»åƒé³¥å±…ã€å¾¡å®ˆã€é–‹é‹ç¹ªé¦¬ã€‚", guide: "<span class='font-bold text-red-700'>åƒæ‹œï¼š</span>å¯é¸çˆ¬å±±ä¸Šå±•æœ›å°ã€‚", isKey: true },
                    { time: "11:30-12:20", title: "åˆé¤ï¼šç¥å¾·é–€å‰ç”º", type: "dining", locationName: "ç¥å¾·é–€å‰ç”º", isKey: false },
                    { time: "13:00-14:30", title: "ğŸ“š æ­¦é›„åœ–æ›¸é¤¨ï¼ˆæœ€ç¾åœ–æ›¸é¤¨ï¼‰", type: "attraction", locationName: "æ­¦é›„å¸‚å›³æ›¸é¤¨", note: "å¯è²·å’–å•¡ä¼‘æ¯ã€‚", guide: "<span class='font-bold text-blue-700'>å°èˆªï¼š</span>æ­¦é›„å¸‚å›³æ›¸é¤¨ï¼ˆåœè»Šä½å¤šï¼‰ã€‚", isKey: true },
                    { time: "14:40-15:40", title: "ğŸŒ³ æ­¦é›„ç¥ç¤¾å¤§æ¥ ï¼ˆæ¨¹é½¡3000å¹´ï¼‰", type: "attraction", locationName: "æ­¦é›„ç¥ç¤¾", note: "çŸ¥åèƒ½é‡æ™¯é»ã€‚å¤§æ¥ åœ¨ç¥ç¤¾å¾Œæ–¹ã€‚", guide: "<span class='font-bold text-green-700'>å¼·çƒˆæ¨è–¦ï¼š</span>æ—¥æœ¬æœ€å¤è€ç´šæ¨¹æœ¨ä¹‹ä¸€ï¼Œå£¯è§€åˆ°æœƒé©šå‘¼ã€‚", isKey: true },
                    { time: "17:00", title: "ğŸš— å›ä½è³€å¸‚å€", type: "transport", locationName: "ä½è³€å¸‚å€", isKey: false },
                    { time: "18:30", title: "æ™šé¤ï¼šShigeru ã—ã’ã‚‹", type: "dining", locationName: "Shigeru ã—ã’ã‚‹", note: "åœ°å€ï¼š1 Chome-2-34 Konohigashi, Sagaã€‚", guide: "<span class='font-bold text-orange-600'>å¿…åƒï¼š</span>æœ‰ç‰›è…¸é‹!", isKey: true },
                ]
            },
            {
                day: 4,
                date: "12/17 (ä¸‰)",
                location: "ä½è³€å¸‚å€æ•£ç­–", // æ ¹æ“šæ–‡ä»¶ï¼Œé€™å¤©æ”¹ç‚ºå¸‚å€æ­¥è¡Œè¡Œç¨‹
                weather: "Saga",
                events: [
                    { time: "09:00-10:00", title: "ğŸ¯ ä½è³€åŸæœ¬ä¸¸æ­·å²é¤¨", type: "attraction", locationName: "ä½è³€åŸæœ¬ä¸¸æ­·å²é¤¨", isKey: true },
                    { time: "10:00-11:00", title: "ğŸ—¾ èˆŠå¤è³€éŠ€è¡Œã€å¾µå¤é¤¨", type: "attraction", locationName: "ä½è³€æ­·å²æ°‘ä¿—é¤¨", note: "Former Koga Bankã€å¾µå¤é¤¨", isKey: false },
                    { time: "11:00-12:30", title: "ğŸ‘˜ å’Œæœå‡ºç§Ÿã€ä½å˜‰ç¥ç¤¾ + åŸè·¡å…¬åœ’", type: "attraction", locationName: "ä½å˜‰ç¥ç¤¾", note: "å’Œæœï¼šã‚ˆãã»ã²å‡¦ãƒ»äºŒè‘‰ (4-16-203 Yanagimachi)", isKey: true },
                    { time: "12:30-13:30", title: "åˆé¤ï¼ˆYoume Town å…§ï¼‰", type: "dining", locationName: "Youme Town", isKey: false },
                    { time: "13:30-15:00", title: "ğŸ› Youme Town è³¼ç‰©æ•£ç­–", type: "shopping", locationName: "Youme Town", guide: "<span class='font-bold text-yellow-700'>è³¼ç‰©é‡é»ï¼š</span>å¤§å‰µã€ç„¡å°è‰¯å“ã€è—¥å¦ã€æ›¸åº—ç­‰ä¸€ç«™å¼å®Œæˆã€‚", isKey: true },
                    { time: "15:30-16:30", title: "ğŸ¨ æŸ³ç”ºè€è¡—æ•£æ­¥", type: "attraction", locationName: "æŸ³ç”ºè€è¡—", note: "å’–å•¡å»³ã€è€è¡—å»ºç¯‰ã€å’Œé¢¨æ‹ç…§å¥½åœ°æ–¹ã€‚", isKey: false },
                    { time: "17:00-18:00", title: "ğŸ› ä½è³€å¹³åƒ¹æ¾¡å ‚", type: "attraction", locationName: "æ¹¯å‡¦ ãˆã³ã™æ¹¯", guide: "<span class='font-bold text-blue-700'>æ¨è–¦ï¼š</span>æ¹¯å‡¦ ãˆã³ã™æ¹¯ï¼ˆé›¢é£¯åº—è¿‘ã€ä¹¾æ·¨ã€ä¾¿å®œï¼‰ã€‚", isKey: false },
                    { time: "18:30", title: "æ™šé¤ï¼šå’Œé¦™èœ ä½è³€é§…å‰åº—", type: "dining", locationName: "å’Œé¦™èœ ä½è³€é§…å‰åº—", note: "åœ¨ MODE BLDG.2, 5Fã€‚", isKey: true },
                ]
            },
            {
                day: 5,
                date: "12/18 (å››)",
                location: "ä½è³€ â†’ æ¡ƒåœ’",
                weather: "Saga",
                events: [
                    { time: "08:30-10:00", title: "ğŸ§³ æ—©é¤ï¼‹æ”¶è¡Œæï¼‹é€€æˆ¿", type: "transport", locationName: "æ±æ©«INNä½è³€ç«™å‰", isKey: false },
                    { time: "10:15", title: "ğŸš æ­ä¹˜æ©Ÿå ´å·´å£«å‰å¾€ä½è³€æ©Ÿå ´", type: "transport", locationName: "ä½è³€æ©Ÿå ´", isKey: false },
                    { time: "12:15-13:45", title: "âœˆï¸ èˆªç­è¿”å›ï¼šä½è³€ â†’ æ¡ƒåœ’", type: "transport", note: "IT247 çµæŸæ—…ç¨‹ã€‚", locationName: "ä½è³€æ©Ÿå ´", isKey: true },
                ]
            }
        ];

        // --- Firebase/LocalStorage (for Budget Tracker) ---
        // ç”±æ–¼æˆ‘å€‘ä¸èƒ½ä½¿ç”¨ç€è¦½å™¨çš„ localStorageï¼Œæˆ‘å°‡ä½¿ç”¨ä¸€å€‹ç°¡å–®çš„ JS è®Šæ•¸ä¾†æ¨¡æ“¬æ•¸æ“šå­˜å„²ï¼Œ
        // ä½†åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œé€™å€‹éƒ¨åˆ†æœƒéœ€è¦ Firestore ä¾†å¯¦ç¾æŒä¹…åŒ–ã€‚
        let expenses = [];

        function addExpense() {
            const itemInput = document.getElementById('expense-item');
            const amountInput = document.getElementById('expense-amount');
            const item = itemInput.value.trim();
            const amount = parseInt(amountInput.value, 10);

            if (item && !isNaN(amount) && amount > 0) {
                expenses.push({ item, amount, id: Date.now() });
                renderExpenses();
                itemInput.value = '';
                amountInput.value = '';
            }
        }

        function deleteExpense(id) {
            expenses = expenses.filter(e => e.id !== id);
            renderExpenses();
        }

        function renderExpenses() {
            const list = document.getElementById('expense-list');
            const totalDisplay = document.getElementById('total-expense');
            list.innerHTML = '';
            let total = 0;

            expenses.forEach(expense => {
                total += expense.amount;
                list.innerHTML += `
                    <div class="flex justify-between items-center text-gray-700 bg-gray-50 p-2 rounded-lg border border-gray-200">
                        <span class="text-sm">${expense.item}</span>
                        <div class="flex items-center">
                            <span class="font-medium mr-2">${expense.amount.toLocaleString()} JPY</span>
                            <button onclick="deleteExpense(${expense.id})" class="text-red-500 hover:text-red-700 transition-colors">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                `;
            });

            totalDisplay.textContent = `${total.toLocaleString()} JPY`;
            lucide.createIcons(); // Re-render icons after adding content
        }

        // --- æ ¸å¿ƒåŠŸèƒ½å‡½æ•¸ ---

        // 1. æ¨¡æ“¬å¤©æ°£ API å‘¼å«
        async function fetchWeatherMock(location) {
            // åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œæ‚¨éœ€è¦æ›¿æ›æˆçœŸæ­£çš„å¤©æ°£ API å‘¼å«ï¼Œä¸¦æä¾› API Keyã€‚
            // ç”±æ–¼å®‰å…¨é™åˆ¶ï¼Œé€™è£¡ä½¿ç”¨ Mock Data ä¾†å±•ç¤ºåŠŸèƒ½ã€‚
            await new Promise(resolve => setTimeout(resolve, 500)); // æ¨¡æ“¬å»¶é²

            const weatherMap = {
                "Saga": { temp: "15Â°C", desc: "æ™´æ™‚å¤šé›²", icon: "sun", color: "text-yellow-600" },
                "Karatsu": { temp: "12Â°C", desc: "å±€éƒ¨å¤šé›²", icon: "cloud", color: "text-gray-600" },
                "Kashima": { temp: "14Â°C", desc: "å°é›¨", icon: "cloud-rain", color: "text-blue-600" },
                "Arita": { temp: "13Â°C", desc: "é™°å¤©", icon: "cloud-drizzle", color: "text-gray-600" }
            };

            const data = weatherMap[location] || weatherMap["Saga"];
            return `<div class="flex items-center text-sm font-semibold ${data.color}">
                        <i data-lucide="${data.icon}" class="w-4 h-4 mr-1"></i>
                        <span>${data.desc} ${data.temp}</span>
                    </div>`;
        }

        // 2. ç”Ÿæˆå°èˆªé€£çµ
        function getNavigationHtml(locationName) {
            if (!locationName) return '';
            // é€™è£¡ä½¿ç”¨ Google Maps çš„ URL æœå°‹ï¼Œåœ¨æ‰‹æ©Ÿä¸Šæœƒè‡ªå‹•å˜—è©¦é–‹å•Ÿ App
            const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent("æ—¥æœ¬ä½è³€ " + locationName)}`;
            return `<a href="${mapUrl}" target="_blank" class="flex items-center justify-center space-x-1 bg-vermilion-50 text-vermilion border border-red-200 px-3 py-1 text-xs rounded-full hover:bg-red-100 transition-colors">
                        <i data-lucide="car" class="w-4 h-4"></i>
                        <span>å°èˆª</span>
                    </a>`;
        }

        // 3. ç”Ÿæˆæ¯æ—¥è¡Œç¨‹å¡ç‰‡
        async function renderItinerary() {
            const list = document.getElementById('itinerary-list');
            list.innerHTML = '<div class="text-center p-8 text-gray-500">æ­£åœ¨è¼‰å…¥è¡Œç¨‹...</div>';
            let html = '';

            for (const dayPlan of itineraryData) {
                const weatherHtml = await fetchWeatherMock(dayPlan.weather);

                html += `
                    <div class="bg-white shadow-xl rounded-xl overflow-hidden border-t-4 border-vermilion transition-transform hover:scale-[1.005]">
                        <!-- æ—¥æœŸèˆ‡å¤©æ°£ -->
                        <div class="p-4 flex justify-between items-center bg-gray-50 border-b">
                            <h3 class="text-xl font-bold text-gray-800">
                                Day ${dayPlan.day} | ${dayPlan.date}
                            </h3>
                            ${weatherHtml}
                        </div>
                        
                        <!-- è¡Œç¨‹åˆ—è¡¨ -->
                        <div class="p-4 space-y-3">
                            ${dayPlan.events.map(event => {
                                // åˆ¤æ–·åœ–æ¨™
                                let icon = '';
                                let color = 'bg-blue-100 text-blue-800';
                                switch (event.type) {
                                    case 'attraction': icon = 'landmark'; color = 'bg-vermilion-50 text-vermilion border border-red-200'; break;
                                    case 'dining': icon = 'utensils'; color = 'bg-green-100 text-green-800'; break;
                                    case 'shopping': icon = 'shopping-bag'; color = 'bg-yellow-100 text-yellow-800'; break;
                                    case 'transport': icon = 'route'; color = 'bg-gray-200 text-gray-700'; break;
                                }

                                return `
                                    <div class="flex items-start space-x-3 pb-3 border-b border-dashed last:border-b-0">
                                        <!-- æ™‚é–“èˆ‡é¡å‹åœ–æ¨™ -->
                                        <div class="flex flex-col items-center flex-shrink-0 pt-1">
                                            <span class="text-xs font-semibold text-gray-500">${event.time}</span>
                                            <div class="p-1 mt-1 rounded-full ${color}">
                                                <i data-lucide="${icon}" class="w-4 h-4"></i>
                                            </div>
                                        </div>

                                        <!-- å…§å®¹ -->
                                        <div class="flex-grow">
                                            <div class="flex justify-between items-center">
                                                <p class="font-semibold text-gray-800 ${event.isKey ? 'text-lg' : 'text-base'}">${event.title}</p>
                                                ${getNavigationHtml(event.locationName)}
                                            </div>
                                            
                                            <!-- å‚™è¨» -->
                                            ${event.note ? `<p class="text-gray-600 text-sm mt-1">${event.note}</p>` : ''}
                                            
                                            <!-- å°éŠæé†’/æ”»ç•¥ -->
                                            ${event.guide ? `<div class="mt-2 p-3 bg-vermilion-50 border-l-4 border-vermilion rounded-r-lg text-sm text-gray-700">
                                                ${event.guide}
                                            </div>` : ''}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            }
            list.innerHTML = html;
            lucide.createIcons(); // é‡æ–°è¼‰å…¥æ‰€æœ‰åœ–æ¨™
        }

        // 4. åˆ†é åˆ‡æ›åŠŸèƒ½
        function showTab(tabId, button) {
            // éš±è—æ‰€æœ‰å…§å®¹
            document.querySelectorAll('.tab-content').forEach(el => el.style.display = 'none');
            // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active æ¨£å¼
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active-tab'));

            // é¡¯ç¤ºé¸ä¸­çš„å…§å®¹
            document.getElementById(tabId).style.display = 'block';
            // ç‚ºé¸ä¸­çš„æŒ‰éˆ•æ·»åŠ  active æ¨£å¼
            button.classList.add('active-tab');
            
            // å¦‚æœåˆ‡æ›åˆ°å·¥å…·é é¢ï¼Œé‡æ–°æ¸²æŸ“è¨˜å¸³åˆ—è¡¨
            if (tabId === 'tools-tab') {
                renderExpenses();
            }
            
            // é‡æ–°è¼‰å…¥åœ–æ¨™
            lucide.createIcons();
        }

        // 5. é¡¯ç¤ºç•¶å‰æ—¥æœŸ
        function updateDateDisplay() {
            const today = new Date();
            const year = today.getFullYear();
            const month = (today.getMonth() + 1).toString().padStart(2, '0');
            const day = today.getDate().toString().padStart(2, '0');
            document.getElementById('date-display').textContent = `${year}/${month}/${day}`;
        }

        // é é¢åŠ è¼‰å®Œæˆå¾ŒåŸ·è¡Œ
        window.onload = () => {
            renderItinerary();
            updateDateDisplay();
            renderExpenses(); // åˆå§‹åŒ–è¨˜å¸³åˆ—è¡¨
        };
    </script>
</body>
</html>